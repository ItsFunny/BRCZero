#!/bin/bash

KEY="captain"
CHAINID="brczero-67"
MONIKER="brczero"
CURDIR=`dirname $0`
HOME_SERVER=$CURDIR/"_cache_evm"

set -e
set -o errexit
set -a
set -m


killbyname() {
  NAME=$1
  ps -ef|grep "$NAME"|grep -v grep |awk '{print "kill -9 "$2", "$8}'
  ps -ef|grep "$NAME"|grep -v grep |awk '{print "kill -9 "$2}' | sh
  echo "All <$NAME> killed!"
}


run() {
    LOG_LEVEL=main:info,iavl:info,*:error,state:info,provider:info
#--mempool.enable_delete_min_gp_tx false \
#    brczerod start --pruning=nothing --rpc.unsafe \
    nohup brczerod start --rpc.unsafe \
      --local-rpc-port 26657 \
      --log_level $LOG_LEVEL \
      --log_file json \
      --dynamic-gp-mode=2 \
      --consensus.timeout_commit 8000ms \
      --tree-enable-async-commit=false \
      --enable-gid \
      --fast-query=false \
      --append-pid=true \
      --iavl-output-modules evm=0,acc=0 \
      --commit-gap-height 3 \
      --trie.dirty-disabled=true \
      --trace --home $HOME_SERVER --chain-id $CHAINID \
      --elapsed Round=1,CommitRound=1,Produce=1 \
      --rest.laddr "tcp://localhost:8545" > brc10.txt 2>&1 &

# --iavl-commit-interval-height \
# --iavl-enable-async-commit \
#      --iavl-cache-size int                              Max size of iavl cache (default 1000000)
#      --iavl-commit-interval-height int                  Max interval to commit node cache into leveldb (default 100)
#      --iavl-debug int                                   Enable iavl project debug
#      --iavl-enable-async-commit                         Enable async commit
#      --iavl-enable-pruning-history-state                Enable pruning history state
#      --iavl-height-orphans-cache-size int               Max orphan version to cache in memory (default 8)
#      --iavl-max-committed-height-num int                Max committed version to cache in memory (default 8)
#      --iavl-min-commit-item-count int                   Min nodes num to triggle node cache commit (default 500000)
#      --iavl-output-modules

}


killbyname brczerod
killbyname brczerocli

set -x # activate debugging

# run

# remove existing daemon and client
rm -rf ~/.brczero*
rm -rf $HOME_SERVER

(cd .. && make install)

# Set up config for CLI
brczerocli config chain-id $CHAINID
brczerocli config output json
brczerocli config indent true
brczerocli config trust-node true
brczerocli config keyring-backend test

# if $KEY exists it should be deleted
#
#    "eth_address": "0xbbE4733d85bc2b90682147779DA49caB38C0aA1F",
#     prikey: 8ff3ca2d9985c3a52b459e2f6e7822b23e1af845961e22128d5f372fb9aa5f17
brczerocli keys add --recover captain -m "puzzle glide follow cruel say burst deliver wild tragic galaxy lumber offer" -y

#    "eth_address": "0x83D83497431C2D3FEab296a9fba4e5FaDD2f7eD0",
brczerocli keys add --recover admin16 -m "palace cube bitter light woman side pave cereal donor bronze twice work" -y

brczerocli keys add --recover admin17 -m "antique onion adult slot sad dizzy sure among cement demise submit scare" -y

brczerocli keys add --recover admin18 -m "lazy cause kite fence gravity regret visa fuel tone clerk motor rent" -y

# Set moniker and chain-id for Ethermint (Moniker can be anything, chain-id must be an integer)
brczerod init $MONIKER --chain-id $CHAINID --home $HOME_SERVER

# Change parameter token denominations to brc10
cat $HOME_SERVER/config/genesis.json | jq '.app_state["staking"]["params"]["bond_denom"]="brc10"' > $HOME_SERVER/config/tmp_genesis.json && mv $HOME_SERVER/config/tmp_genesis.json $HOME_SERVER/config/genesis.json
cat $HOME_SERVER/config/genesis.json | jq '.app_state["crisis"]["constant_fee"]["denom"]="brc10"' > $HOME_SERVER/config/tmp_genesis.json && mv $HOME_SERVER/config/tmp_genesis.json $HOME_SERVER/config/genesis.json
cat $HOME_SERVER/config/genesis.json | jq '.app_state["gov"]["deposit_params"]["min_deposit"][0]["denom"]="brc10"' > $HOME_SERVER/config/tmp_genesis.json && mv $HOME_SERVER/config/tmp_genesis.json $HOME_SERVER/config/genesis.json
cat $HOME_SERVER/config/genesis.json | jq '.app_state["mint"]["params"]["mint_denom"]="brc10"' > $HOME_SERVER/config/tmp_genesis.json && mv $HOME_SERVER/config/tmp_genesis.json $HOME_SERVER/config/genesis.json

# Enable EVM

if [ "$(uname -s)" == "Darwin" ]; then
    sed -i "" 's/"enable_call": false/"enable_call": true/' $HOME_SERVER/config/genesis.json
    sed -i "" 's/"enable_create": false/"enable_create": true/' $HOME_SERVER/config/genesis.json
    sed -i "" 's/"enable_contract_blocked_list": false/"enable_contract_blocked_list": true/' $HOME_SERVER/config/genesis.json
else
    sed -i 's/"enable_call": false/"enable_call": true/' $HOME_SERVER/config/genesis.json
    sed -i 's/"enable_create": false/"enable_create": true/' $HOME_SERVER/config/genesis.json
    sed -i 's/"enable_contract_blocked_list": false/"enable_contract_blocked_list": true/' $HOME_SERVER/config/genesis.json
fi

# Allocate genesis accounts (cosmos formatted addresses)
brczerod add-genesis-account $(brczerocli keys show $KEY    -a) 100000000brc10 --home $HOME_SERVER
brczerod add-genesis-account $(brczerocli keys show admin16 -a) 900000000brc10 --home $HOME_SERVER
brczerod add-genesis-account $(brczerocli keys show admin17 -a) 900000000brc10 --home $HOME_SERVER
brczerod add-genesis-account $(brczerocli keys show admin18 -a) 900000000brc10 --home $HOME_SERVER

# Sign genesis transaction
brczerod gentx --name $KEY --keyring-backend test --home $HOME_SERVER

brczerod geninscription \
  --inscription "{\"d\":\"608060405234801561001057600080fd5b506141d9806100206000396000f3fe60806040523480156200001157600080fd5b5060043610620000c35760003560e01c806385410acd116200007a57806385410acd1462000153578063cb60a0a21462000153578063d57dc253146200015c578063ded3384c14620000c8578063e7ab22e014620000e4578063e8d5e69a146200016657600080fd5b8063088946d414620000c8578063360b5d8e14620000e4578063447c638014620000e457806358648cdf14620000ed57806361062d9214620000f65780636ac3d07b1462000126575b600080fd5b620000d1600581565b6040519081526020015b60405180910390f35b620000d1600481565b620000d1601281565b6200010d62000107366004620025e6565b6200017f565b6040516001600160a01b039091168152602001620000db565b6200013d620001373660046200261f565b620001bf565b60408051928352602083019190915201620000db565b620000d1600681565b6200010d61100081565b6200017d62000177366004620026ea565b620002fd565b005b60006200018c826200052d565b9150600082604051620001a091906200292a565b908152604051908190036020019020546001600160a01b031692915050565b600080620001cd836200052d565b925060006001600160a01b0316600084604051620001ec91906200292a565b908152604051908190036020019020546001600160a01b03161415620002515760405162461bcd60e51b8152602060048201526015602482015274109490cc8c081a5cc81b9bdd0819195c1b1bde5959605a1b60448201526064015b60405180910390fd5b6000836040516200026391906200292a565b908152604051908190036020018120546335ee5f8760e01b82526001600160a01b0316906335ee5f87906200029d90879060040162002976565b604080518083038186803b158015620002b557600080fd5b505afa158015620002ca573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620002f091906200298b565b90925090505b9250929050565b60006200030a826200062d565b90506200034962000341604051806040016040528060048152602001631137b81160e11b815250836200064f90919063ffffffff16565b516007161590565b156200038e5760405162461bcd60e51b81526020600482015260136024820152721bdc195c985d1a5bdb881d5b9919599a5b9959606a1b604482015260640162000248565b6200040160405180604001604052806008815260200167113232b83637bc9160c11b815250620003ee620003e8604051806040016040528060048152602001631137b81160e11b815250856200064f90919063ffffffff16565b620006c5565b8151602092830120815191909201201490565b156200041857620004138382620006d6565b505050565b62000470604051806040016040528060068152602001651136b4b73a1160d11b815250620003ee620003e8604051806040016040528060048152602001631137b81160e11b815250856200064f90919063ffffffff16565b15620004825762000413838262000784565b620004de6040518060400160405280600a815260200169113a3930b739b332b91160b11b815250620003ee620003e8604051806040016040528060048152602001631137b81160e11b815250856200064f90919063ffffffff16565b15620004f05762000413838262000827565b60405162461bcd60e51b815260206004820152601160248201527034b63632b3b0b61037b832b930ba34b7b760791b604482015260640162000248565b60606000806110006001600160a01b03168460405160240162000551919062002976565b60408051601f198184030181529181526020820180516001600160e01b0316639416b42360e01b179052516200058891906200292a565b600060405180830381855afa9150503d8060008114620005c5576040519150601f19603f3d011682016040523d82523d6000602084013e620005ca565b606091505b5091509150816200060f5760405162461bcd60e51b815260206004820152600e60248201526d1d1bd31bddd95c8819985a5b195960921b604482015260640162000248565b80806020019051810190620006259190620029b0565b949350505050565b6040805160008082529181905290620006488360ff620008fb565b9392505050565b60408051600081529052815160609060071660021415620006bf578151602083012060006200067e856200119d565b805190915060051b5b8015620006bb57818101519550601f190182620006a487620011af565b8051906020012014620006b75762000687565b8593505b5050505b92915050565b6060600062000648836000620008fb565b6000620006e382620011d1565b9050600081600001518260400151836080015184606001516040516200070990620024da565b62000718949392919062002a27565b604051809103906000f08015801562000735573d6000803e3d6000fd5b50905080600083602001516040516200074f91906200292a565b90815260405190819003602001902080546001600160a01b03929092166001600160a01b031990921691909117905550505050565b6000620007918262001758565b905060008160000151604051620007a991906200292a565b908152604051602091819003820181205460a0860151928401516302b580e760e11b83526001600160a01b039091169263056b01ce92620007ee929060040162002a58565b600060405180830381600087803b1580156200080957600080fd5b505af11580156200081e573d6000803e3d6000fd5b50505050505050565b6000620008348262001a7a565b9050600081600001516040516200084c91906200292a565b908152604080516020928190038301812054865192870151608088015160a0890151958701516304659b7d60e31b85526001600160a01b039093169563232cdbe8956200089f9590949060040162002a7c565b602060405180830381600087803b158015620008ba57600080fd5b505af1158015620008cf573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620008f5919062002ad6565b50505050565b6000620010e0565b63101827966000526004601cfd5b805b600164010000260062000927835160001a90565b1c166200093457620006bf565b60010162000913565b63ffffffff83113d3d3e63ffffffff821b191691901b1790565b6040516200097d848603607862000977601f19868903016058886200093d565b6200093d565b959095178552505050602082016040525090565b600080620009a48460186000516200093d565b620009b0878762000911565b9150868210620009c1575062000b0d565b815160001a6022811415620009fa5782620009df8985858962000d6b565b9350620009f160048583868a62000957565b94505062000afc565b605b81141562000a1c5762000a128884848862000b16565b9350935062000afc565b607b81141562000a345762000a128884848862000bfe565b6703ff200000000000811c6001161562000a565762000a128884848862000e5c565b87600484011162000aba5782835160e01c637472756581141562000a945760048501945062000a8a60058684878b62000957565b9550505062000afc565b636e756c6c81141562000ab75760048501945062000a8a60068684878b62000957565b50505b87600584011162000af25782835160d81c6466616c736581141562000aef5760058501945062000a8a60058684878b62000957565b50505b62000afc62000903565b505062000b0a868262000911565b90505b94509492505050565b600060018401815b86821062000b305762000b3062000903565b8262000b5f5762000b42878362000911565b9150605d62000b52835160001a90565b141562000b5f5762000bcf565b62000b6d8783858762000991565b92509250821562000bbf5762000b8a81609885516040176200093d565b835260010162000b9b825160001a90565b605d81141562000bac575062000bcf565b602c81141562000bbd575062000bc3565b505b8691505b60018201915062000b1e565b5060010162000be1826038866200093d565b935062000bf360018287878762000957565b915094509492505050565b6000600184015b85811062000c175762000c1762000903565b8162000c465762000c29868262000911565b9050607d62000c39825160001a90565b141562000c465762000d00565b62000c52868262000911565b90508062000c638783858762000d6b565b62000c6f888262000911565b9250603a62000c7f845160001a90565b141562000cf15762000c978860018501868862000991565b93509350831562000cf15762000cc260208601830360986200097785850360b889516080176200093d565b8452825160001a607d81141562000cdc5750505062000d00565b602c81141562000cef5750505062000cf7565b505b50508590505b60010162000c05565b60010162000d11826038866200093d565b935062000bf360028287878762000957565b6001667e0000007e03ff603062000d3d8585015160001a90565b031c1662000d4f5762000d4f62000903565b6005821462000d675762000d67600183018262000d23565b5050565b5050600082821062000d815762000d8162000903565b50600181015b805160001a602281141562000d9d575062000e04565b605c811462000db0575060010162000d87565b600182015160001a905060016a0510110400000000002001602283031c161562000dde575060020162000d87565b607581141562000dff5762000df560028362000d23565b5060060162000d87565b508290505b82811062000e165762000e1662000903565b60010192915050565b805b600a603062000e31835160001a90565b031062000e3e5762000e47565b60010162000e21565b80821484161562000648576200064862000903565b600083602d62000e6d825160001a90565b141562000e78576001015b600a603062000e88835160001a90565b031062000e995762000e9962000903565b805160001a6001820191506030811462000ebe5762000ebb6000888462000e1f565b91505b50602e62000ecd825160001a90565b141562000ee85762000ee56001876001840162000e1f565b90505b805160658160001a602017141562000f1b5762000f186001886001850162010001600e8660011a031a0162000e1f565b91505b5062000bf360038287878762000957565b60405190820190601f19601f850181165b838101518382015281018062000f535762000f59565b62000f3d565b50508381526000846020830101528360408201016040529392505050565b848362000f2c565b50919050565b80516060906002816007161162000f7f5782158115171562000fa75762000f7f565b602081161562000fc457603881901c63ffffffff16915062000f7f565b604051915060208201603882901c63ffffffff165b80156200100f578082528051601881901c63ffffffff1662000ffe876018846200093d565b909252506020919091019062000fd9565b50601f1983820381018060051c85528260405262001030856038866200093d565b93508360201786526040811062001071576020850192508085015b8351815185528152602090930192820180841062001069576200106f565b6200104b565b505b50505050919050565b805160609082158115171562001091575062000625565b80841c63ffffffff169150808616620010d75760d881901c63ffffffff16620010c282871c63ffffffff1662000f77565b925050620010d28285836200093d565b861783525b50949350505050565b8180156200115e5760018114620011775760038114620011885760208401845181018082146200114057805160001a60228253620011258760d8601160f91b6200093d565b60005262001137828460008a62000991565b93509450808253505b8315818310171562001156576200115662000903565b505062001196565b6200116f601060786058876200107a565b915062001196565b6200116f600860b86098876200107a565b620011938462000f85565b91505b5092915050565b6060600062000648835b6003620008fb565b805160609060801615620011cc57600062000648836001620008fb565b919050565b620012046040518060a0016040528060608152602001606081526020016000815260200160008152602001600081525090565b6000620012118362001ed6565b90506000806000600484101580156200122b575060068411155b620012855760405162461bcd60e51b8152602060048201526024808201527f6f7065726174696f6e206465706c6f79203a206974656d2053697a6520696c6c6044820152631959d85b60e21b606482015260840162000248565b620012bb62000341604051806040016040528060058152602001641136b0bc1160d91b815250886200064f90919063ffffffff16565b15620013165760405162461bcd60e51b8152602060048201526024808201527f6f7065726174696f6e206465706c6f79203a206d617820697320756e646566696044820152631b99195960e21b606482015260840162000248565b6200134d6200034160405180604001604052806006815260200165113a34b1b59160d11b815250886200064f90919063ffffffff16565b15620013aa5760405162461bcd60e51b815260206004820152602560248201527f6f7065726174696f6e206465706c6f79203a207469636b20697320756e6465666044820152641a5b99195960da1b606482015260840162000248565b6004841415620013ed5760129250620013e286604051806040016040528060058152602001641136b0bc1160d91b8152508562001eec565b915081905062001684565b60058414156200154f576200142d6200034160405180604001604052806005815260200164113634b69160d91b815250886200064f90919063ffffffff16565b6200149457601292506200146086604051806040016040528060058152602001641136b0bc1160d91b8152508562001eec565b91506200148c8660405180604001604052806005815260200164113634b69160d91b8152508562001eec565b905062001684565b620014ca6200034160405180604001604052806005815260200164113232b19160d91b815250886200064f90919063ffffffff16565b6200150657620014da8662001fa6565b9250620013e286604051806040016040528060058152602001641136b0bc1160d91b8152508562001eec565b60405162461bcd60e51b815260206004820152601e60248201527f6f7065726174696f6e206465706c6f79203a206b657920696c6c6567616c0000604482015260640162000248565b600684141562001684576200158f6200034160405180604001604052806005815260200164113634b69160d91b815250886200064f90919063ffffffff16565b158015620015d05750620015ce6200034160405180604001604052806005815260200164113232b19160d91b815250886200064f90919063ffffffff16565b155b6200161e5760405162461bcd60e51b815260206004820152601e60248201527f6f7065726174696f6e206465706c6f79203a206b657920696c6c6567616c0000604482015260640162000248565b620016298662001fa6565b92506200165586604051806040016040528060058152602001641136b0bc1160d91b8152508562001eec565b9150620016818660405180604001604052806005815260200164113634b69160d91b8152508562001eec565b90505b60008062001692886200204e565b9150915060006001600160a01b0316600082604051620016b391906200292a565b908152604051908190036020019020546001600160a01b031614620017295760405162461bcd60e51b815260206004820152602560248201527f6f7065726174696f6e206465706c6f79203a20425243323020686173206465706044820152641b1bde595960da1b606482015260840162000248565b6040805160a0810182529283526020830191909152810192909252606082015260808101919091529392505050565b60408051808201909152606081526000602082015260046200177a8362001ed6565b14620017d45760405162461bcd60e51b815260206004820152602260248201527f6f7065726174696f6e206d696e74203a206974656d2053697a6520696c6c6567604482015261185b60f21b606482015260840162000248565b6200180b6200034160405180604001604052806006815260200165113a34b1b59160d11b815250846200064f90919063ffffffff16565b15620018665760405162461bcd60e51b815260206004820152602360248201527f6f7065726174696f6e206d696e74203a207469636b20697320756e646566696e60448201526219195960ea1b606482015260840162000248565b6200189c62000341604051806040016040528060058152602001641130b6ba1160d91b815250846200064f90919063ffffffff16565b15620018f65760405162461bcd60e51b815260206004820152602260248201527f6f7065726174696f6e206d696e74203a20616d7420697320756e646566696e64604482015261195960f21b606482015260840162000248565b60008062001904846200204e565b9150915060006001600160a01b03166000826040516200192591906200292a565b908152604051908190036020019020546001600160a01b031614156200199d5760405162461bcd60e51b815260206004820152602660248201527f6f7065726174696f6e206d696e74203a204252433230206973206e6f742064656044820152651c1b1bde595960d21b606482015260840162000248565b600062001a6085604051806040016040528060058152602001641130b6ba1160d91b815250600085604051620019d491906200292a565b9081526040805160209281900383018120546376809ce360e01b825291516001600160a01b03909216926376809ce392600480840193829003018186803b15801562001a1f57600080fd5b505afa15801562001a34573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001a5a919062002af6565b62001eec565b604080518082019091529283526020830152509392505050565b604080518082019091526060815260006020820152600062001a9c8362001ed6565b90506004811015801562001ab1575060068111155b62001b0e5760405162461bcd60e51b815260206004820152602660248201527f6f7065726174696f6e207472616e73666572203a206974656d2053697a6520696044820152651b1b1959d85b60d21b606482015260840162000248565b62001b456200034160405180604001604052806006815260200165113a34b1b59160d11b815250856200064f90919063ffffffff16565b1562001ba45760405162461bcd60e51b815260206004820152602760248201527f6f7065726174696f6e207472616e73666572203a207469636b20697320756e6460448201526619599a5b99195960ca1b606482015260840162000248565b62001bda62000341604051806040016040528060058152602001641130b6ba1160d91b815250856200064f90919063ffffffff16565b1562001c385760405162461bcd60e51b815260206004820152602660248201527f6f7065726174696f6e207472616e73666572203a20616d7420697320756e6465604482015265199a5b99195960d21b606482015260840162000248565b600581141562001d0b5762001c776200034160405180604001604052806004815260200163113a379160e11b815250856200064f90919063ffffffff16565b158062001cb7575062001cb56200034160405180604001604052806005815260200164113332b29160d91b815250856200064f90919063ffffffff16565b155b62001d055760405162461bcd60e51b815260206004820181905260248201527f6f7065726174696f6e207472616e73666572203a206b657920696c6c6567616c604482015260640162000248565b62001dd9565b600681141562001dd95762001d4a6200034160405180604001604052806004815260200163113a379160e11b815250856200064f90919063ffffffff16565b15801562001d8b575062001d896200034160405180604001604052806005815260200164113332b29160d91b815250856200064f90919063ffffffff16565b155b62001dd95760405162461bcd60e51b815260206004820181905260248201527f6f7065726174696f6e207472616e73666572203a206b657920696c6c6567616c604482015260640162000248565b60008062001de7856200204e565b9150915060006001600160a01b031660008260405162001e0891906200292a565b908152604051908190036020019020546001600160a01b0316141562001e845760405162461bcd60e51b815260206004820152602a60248201527f6f7065726174696f6e207472616e73666572203a204252433230206973206e6f6044820152691d0819195c1b1bde595960b21b606482015260840162000248565b600062001ebb86604051806040016040528060058152602001641130b6ba1160d91b815250600085604051620019d491906200292a565b60408051808201909152928352602083015250949350505050565b60008062001ee483620011a7565b519392505050565b600062001f1362001f0c62001f06620003e887876200064f565b620020a0565b8362002353565b905060008111801562001f46575062001f2e82600a62002c23565b62001f429067ffffffffffffffff62002c31565b8111155b620006485760405162461bcd60e51b815260206004820152602960248201527f6465636f64654e756d626572416e64466f726d616c697a65203a20696c6c656760448201526830b610373ab6b132b960b91b606482015260840162000248565b600062001fec62001fe662001f06620003e860405180604001604052806005815260200164113232b19160d91b815250866200064f90919063ffffffff16565b6200245a565b905060128111158015620020005750600081115b620011cc5760405162461bcd60e51b815260206004820152601760248201527f6465636f6465446563203a20696c6c6567616c20646563000000000000000000604482015260640162000248565b6060806200208c62001f06620003e860405180604001604052806006815260200165113a34b1b59160d11b815250866200064f90919063ffffffff16565b915062002099826200052d565b9050915091565b606062002217565b60008060048301905083811115835160005b600481146200210957603082821a0383667e0000007e03ff821c16620020e457620020e462000903565b6030811160051b6007601083110201900360049590951b9490940193600101620020ba565b5050509250929050565b600080620021228484620020a8565b9150915061dbff821161d800831017620002f6578051615c758160f01c1485029450620021538560028401620020a8565b92509050806103ff16836103ff16600a1b0162010000019250509250929050565b6000607f83116200218d578282535060018101620006bf565b82601f538260061c601e536107ff8311620021be57600051611f3f1661c0801760f01b8252600282019050620006bf565b82600c1c601d5361ffff8311620021ed57600051620f3f3f1662e080801760e81b8252600382019050620006bf565b8260121c601c535060005163073f3f3f1663f08080801760e01b81526211000090911060021b0190565b8151808301601f01805160001a600285015161ff00161761222214600183111662002246576200224662000903565b6020604051019150602184015b8181146200233357805160001a600182019150605c81146200228c576022811462002288578084536001840193505062002253565b8291505b508181146200232957805160001a6001918201916b100000000000800400000000821c1615620022c6578084536001840193505062002253565b6075811415620022f557620022dc838362002113565b92509050620022ec818562002174565b93505062002253565b72080000000c000000000000000a0000000d00096054199091011a801562002327578084536001840193505062002253565b505b6200233362000903565b505060008152604051915060208201810382526020810160405250919050565b60008060006110006001600160a01b031685856040516024016200237992919062002a58565b60408051601f198184030181529181526020820180516001600160e01b0316633088771f60e11b17905251620023b091906200292a565b600060405180830381855afa9150503d8060008114620023ed576040519150601f19603f3d011682016040523d82523d6000602084013e620023f2565b606091505b5091509150816200243b5760405162461bcd60e51b8152602060048201526012602482015271185d1bda55da5d1a111958c819985a5b195960721b604482015260640162000248565b8080602001905181019062002451919062002af6565b95945050505050565b80516000907f1999999999999999999999999999999999999999999999999999999999999999825b600181019050603060ff82870151160382851185600a028281019650600983118188108317171586029550505050828110620024be57620024c4565b62002482565b50508062000f7f5763101827966000526004601cfd5b6115508062002c5483390190565b634e487b7160e01b600052604160045260246000fd5b6040516101a0810167ffffffffffffffff81118282101715620025255762002525620024e8565b60405290565b604051601f8201601f1916810167ffffffffffffffff81118282101715620025575762002557620024e8565b604052919050565b600067ffffffffffffffff8211156200257c576200257c620024e8565b50601f01601f191660200190565b600082601f8301126200259c57600080fd5b8135620025b3620025ad826200255f565b6200252b565b818152846020838601011115620025c957600080fd5b816020850160208301376000918101602001919091529392505050565b600060208284031215620025f957600080fd5b813567ffffffffffffffff8111156200261157600080fd5b62001193848285016200258a565b600080604083850312156200263357600080fd5b823567ffffffffffffffff808211156200264c57600080fd5b6200265a868387016200258a565b935060208501359150808211156200267157600080fd5b5062002680858286016200258a565b9150509250929050565b8035600781900b8114620011cc57600080fd5b8015158114620026ac57600080fd5b50565b8035620011cc816200269d565b803563ffffffff81168114620011cc57600080fd5b803567ffffffffffffffff81168114620011cc57600080fd5b60008060408385031215620026fe57600080fd5b823567ffffffffffffffff808211156200271757600080fd5b908401906101a082870312156200272d57600080fd5b62002737620024fe565b8235828111156200274757600080fd5b62002755888286016200258a565b82525062002766602084016200268a565b60208201526200277960408401620026af565b60408201526060830135828111156200279157600080fd5b6200279f888286016200258a565b606083015250608083013582811115620027b857600080fd5b620027c6888286016200258a565b60808301525060a083013582811115620027df57600080fd5b620027ed888286016200258a565b60a08301525060c0830135828111156200280657600080fd5b62002814888286016200258a565b60c08301525060e0830135828111156200282d57600080fd5b6200283b888286016200258a565b60e08301525061010080840135838111156200285657600080fd5b62002864898287016200258a565b82840152505061012080840135838111156200287f57600080fd5b6200288d898287016200258a565b8284015250506101408084013583811115620028a857600080fd5b620028b6898287016200258a565b828401525050610160620028cc818501620026bc565b90820152610180620028e0848201620026d1565b90820152935060208501359150808211156200267157600080fd5b60005b8381101562002918578181015183820152602001620028fe565b83811115620008f55750506000910152565b600082516200293e818460208701620028fb565b9190910192915050565b6000815180845262002962816020860160208601620028fb565b601f01601f19169290920160200192915050565b60208152600062000648602083018462002948565b600080604083850312156200299f57600080fd5b505080516020909101519092909150565b600060208284031215620029c357600080fd5b815167ffffffffffffffff811115620029db57600080fd5b8201601f81018413620029ed57600080fd5b8051620029fe620025ad826200255f565b81815285602083850101111562002a1457600080fd5b62002451826020830160208601620028fb565b60808152600062002a3c608083018762002948565b6020830195909552506040810192909252606090910152919050565b60408152600062002a6d604083018562002948565b90508260208301529392505050565b60a08152600062002a9160a083018862002948565b8615156020840152828103604084015262002aad818762002948565b9050828103606084015262002ac3818662002948565b9150508260808301529695505050505050565b60006020828403121562002ae957600080fd5b815162000648816200269d565b60006020828403121562002b0957600080fd5b5051919050565b634e487b7160e01b600052601160045260246000fd5b600181815b8085111562002b6757816000190482111562002b4b5762002b4b62002b10565b8085161562002b5957918102915b93841c939080029062002b2b565b509250929050565b60008262002b8057506001620006bf565b8162002b8f57506000620006bf565b816001811462002ba8576002811462002bb35762002bd3565b6001915050620006bf565b60ff84111562002bc75762002bc762002b10565b50506001821b620006bf565b5060208310610133831016604e8410600b841016171562002bf8575081810a620006bf565b62002c04838362002b26565b806000190482111562002c1b5762002c1b62002b10565b029392505050565b600062000648838362002b6f565b600081600019048311821515161562002c4e5762002c4e62002b10565b50029056fe60e06040523480156200001157600080fd5b5060405162001550380380620015508339810160408190526200003491620001d8565b60048451146200007c5760405162461bcd60e51b815260206004820152600f60248201526e1d1a58dac81a5cc8125b9d985b1a59608a1b604482015260640160405180910390fd5b8351620000919060049060208701906200011c565b50608083905260a082905260c0819052600580546001600160a01b03191633179055604051620000c4906004906200030d565b6040805191829003822060805160a05160c051918552602085015283830152905190917f8b96578f52853b0d9b5c01ad99fb15e5d2d20ea7fb35fd154498a4b337d483e2919081900360600190a250505050620003b1565b8280546200012a90620002d0565b90600052602060002090601f0160209004810192826200014e576000855562000199565b82601f106200016957805160ff191683800117855562000199565b8280016001018555821562000199579182015b82811115620001995782518255916020019190600101906200017c565b50620001a7929150620001ab565b5090565b5b80821115620001a75760008155600101620001ac565b634e487b7160e01b600052604160045260246000fd5b60008060008060808587031215620001ef57600080fd5b84516001600160401b03808211156200020757600080fd5b818701915087601f8301126200021c57600080fd5b815181811115620002315762000231620001c2565b604051601f8201601f19908116603f011681019083821181831017156200025c576200025c620001c2565b81604052828152602093508a848487010111156200027957600080fd5b600091505b828210156200029d57848201840151818301850152908301906200027e565b82821115620002af5760008484830101525b9289015160408a01516060909a0151939b909a509297509195505050505050565b600181811c90821680620002e557607f821691505b602082108114156200030757634e487b7160e01b600052602260045260246000fd5b50919050565b600080835481600182811c9150808316806200032a57607f831692505b60208084108214156200034b57634e487b7160e01b86526022600452602486fd5b8180156200036257600181146200037457620003a3565b60ff19861689528489019650620003a3565b60008a81526020902060005b868110156200039b5781548b82015290850190830162000380565b505084890196505b509498975050505050505050565b60805160a05160c051611154620003fc6000396000818161015701526102b401526000818160e5015261017b0152600081816101ad01528181610243015261037a01526111546000f3fe608060405234801561001057600080fd5b506004361061009e5760003560e01c8063728c97ba11610066578063728c97ba1461015257806376809ce3146101795780637e66f15f1461019f578063d5abeb01146101a8578063eb88f52c146101cf57600080fd5b8063056b01ce146100a3578063232cdbe8146100b8578063313ce567146100e057806335ee5f87146101155780633eaf5d9f1461013d575b600080fd5b6100b66100b1366004610db5565b6101f1565b005b6100cb6100c6366004610dfa565b610484565b60405190151581526020015b60405180910390f35b6101077f000000000000000000000000000000000000000000000000000000000000000081565b6040519081526020016100d7565b610128610123366004610ea4565b610552565b604080519283526020830191909152016100d7565b61014561059c565b6040516100d79190610f3d565b6101077f000000000000000000000000000000000000000000000000000000000000000081565b7f0000000000000000000000000000000000000000000000000000000000000000610107565b61010760035481565b6101077f000000000000000000000000000000000000000000000000000000000000000081565b6101e26101dd366004610ea4565b61062a565b6040516100d793929190610f57565b6005546001600160a01b031633146102415760405162461bcd60e51b815260206004820152600e60248201526d1b9bdd08195b9d1c9e541bda5b9d60921b60448201526064015b60405180910390fd5b7f0000000000000000000000000000000000000000000000000000000000000000600354106102b25760405162461bcd60e51b815260206004820152601f60248201527f6d696e743a20746f74616c537570706c79206973206e6f7420656e6f756768006044820152606401610238565b7f00000000000000000000000000000000000000000000000000000000000000008111156103225760405162461bcd60e51b815260206004820152601760248201527f6d696e743a20416d6f756e744578636565644c696d69740000000000000000006044820152606401610238565b60008251116103735760405162461bcd60e51b815260206004820152601760248201527f6d696e743a20726563656976657220697320656d7074790000000000000000006044820152606401610238565b60006003547f00000000000000000000000000000000000000000000000000000000000000006103a39190610f98565b90508181116103b257806103b4565b815b9050806000846040516103c79190610faf565b908152602001604051809103902060008282546103e49190610fcb565b92505081905550806001846040516103fc9190610faf565b908152602001604051809103902060008282546104199190610fcb565b9250508190555080600360008282546104329190610fcb565b9091555050604051610445908490610faf565b604051908190038120838252907f0a4e1e5035320483d096cf114513007c4eda3853a4dca806da2d9faec60470a69060200160405180910390a2505050565b6005546000906001600160a01b031633146104d25760405162461bcd60e51b815260206004820152600e60248201526d1b9bdd08195b9d1c9e541bda5b9d60921b6044820152606401610238565b60008651116105235760405162461bcd60e51b815260206004820181905260248201527f7472616e736665723a20696e736372697074696f6e496420697320656d7074796044820152606401610238565b841561053b57610534868585610720565b9050610549565b6105468684846109fc565b90505b95945050505050565b6000806000836040516105659190610faf565b9081526020016040518091039020546001846040516105849190610faf565b90815260200160405180910390205491509150915091565b600480546105a990610fe3565b80601f01602080910402602001604051908101604052809291908181526020018280546105d590610fe3565b80156106225780601f106105f757610100808354040283529160200191610622565b820191906000526020600020905b81548152906001019060200180831161060557829003601f168201915b505050505081565b600060606000806002856040516106419190610faf565b90815260200160405180910390206040518060600160405290816000820154815260200160018201805461067490610fe3565b80601f01602080910402602001604051908101604052809291908181526020018280546106a090610fe3565b80156106ed5780601f106106c2576101008083540402835291602001916106ed565b820191906000526020600020905b8154815290600101906020018083116106d057829003601f168201915b50505091835250506002919091015460ff1615156020918201528151908201516040909201519097919650945092505050565b6000808351116107725760405162461bcd60e51b815260206004820152601b60248201527f7472616e736665723a20726563656976657220697320656d70747900000000006044820152606401610238565b60006002856040516107849190610faf565b908152604051908190036020019020600281015490915060ff166107ea5760405162461bcd60e51b815260206004820152601f60248201527f7472616e736665723a20496e736372697074696f6e49642069732075736564006044820152606401610238565b836040516020016107fb9190610f3d565b6040516020818303038152906040528051906020012081600101604051602001610825919061101e565b60405160208183030381529060405280519060200120146108885760405162461bcd60e51b815260206004820152601d60248201527f7472616e736665723a2073656e646572206973206e6f74206f776e65720000006044820152606401610238565b8251610892578392505b805460405181906000906108a7908790610faf565b908152602001604051809103902060008282546108c49190610fcb565b92505081905550806001856040516108dc9190610faf565b908152602001604051809103902060008282546108f99190610fcb565b92505081905550806000866040516109119190610faf565b9081526020016040518091039020600082825461092e9190610f98565b90915550506002808301805460ff19169055604051839190610951908990610faf565b90815260405190819003602001902081548155600180830180549183019161097890610fe3565b610983929190610bfe565b506002918201549101805460ff191660ff90921615159190911790556040516109ad908790610faf565b60405180910390207fb6752a02aea22f4f1c02347b9d017ea326062cda48cfb3ef0005ea49f2f313fc8686846040516109e8939291906110c6565b60405180910390a250600195945050505050565b600080835111610a4e5760405162461bcd60e51b815260206004820152601b60248201527f7472616e736665723a20726563656976657220697320656d70747900000000006044820152606401610238565b6000610a598561062a565b509150508051600014610aae5760405162461bcd60e51b815260206004820181905260248201527f7472616e736665723a20696e736372697074696f6e49642069732065786973746044820152606401610238565b6000610ab985610552565b91505083811015610b0c5760405162461bcd60e51b815260206004820152601d60248201527f7472616e736665723a20496e73756666696369656e7442616c616e63650000006044820152606401610238565b83600186604051610b1d9190610faf565b90815260200160405180910390206000828254610b3a9190610f98565b909155505060408051606081018252858152602081018790526001818301529051600290610b69908990610faf565b9081526020016040518091039020600082015181600001556020820151816001019080519060200190610b9d929190610c89565b50604091820151600291909101805460ff191691151591909117905551610bc5908790610faf565b60405180910390207fde5be852f1d688b065442932fde83e800e2f1fe1af76f433f88a2fb9229dec1686866040516109e89291906110fc565b828054610c0a90610fe3565b90600052602060002090601f016020900481019282610c2c5760008555610c79565b82601f10610c3d5780548555610c79565b82800160010185558215610c7957600052602060002091601f016020900482015b82811115610c79578254825591600101919060010190610c5e565b50610c85929150610cfd565b5090565b828054610c9590610fe3565b90600052602060002090601f016020900481019282610cb75760008555610c79565b82601f10610cd057805160ff1916838001178555610c79565b82800160010185558215610c79579182015b82811115610c79578251825591602001919060010190610ce2565b5b80821115610c855760008155600101610cfe565b634e487b7160e01b600052604160045260246000fd5b600082601f830112610d3957600080fd5b813567ffffffffffffffff80821115610d5457610d54610d12565b604051601f8301601f19908116603f01168101908282118183101715610d7c57610d7c610d12565b81604052838152866020858801011115610d9557600080fd5b836020870160208301376000602085830101528094505050505092915050565b60008060408385031215610dc857600080fd5b823567ffffffffffffffff811115610ddf57600080fd5b610deb85828601610d28565b95602094909401359450505050565b600080600080600060a08688031215610e1257600080fd5b853567ffffffffffffffff80821115610e2a57600080fd5b610e3689838a01610d28565b9650602088013591508115158214610e4d57600080fd5b90945060408701359080821115610e6357600080fd5b610e6f89838a01610d28565b94506060880135915080821115610e8557600080fd5b50610e9288828901610d28565b95989497509295608001359392505050565b600060208284031215610eb657600080fd5b813567ffffffffffffffff811115610ecd57600080fd5b610ed984828501610d28565b949350505050565b60005b83811015610efc578181015183820152602001610ee4565b83811115610f0b576000848401525b50505050565b60008151808452610f29816020860160208601610ee1565b601f01601f19169290920160200192915050565b602081526000610f506020830184610f11565b9392505050565b838152606060208201526000610f706060830185610f11565b90508215156040830152949350505050565b634e487b7160e01b600052601160045260246000fd5b600082821015610faa57610faa610f82565b500390565b60008251610fc1818460208701610ee1565b9190910192915050565b60008219821115610fde57610fde610f82565b500190565b600181811c90821680610ff757607f821691505b6020821081141561101857634e487b7160e01b600052602260045260246000fd5b50919050565b600060208083526000845481600182811c91508083168061104057607f831692505b85831081141561105e57634e487b7160e01b85526022600452602485fd5b87860183815260200181801561107b576001811461108c576110b7565b60ff198616825287820196506110b7565b60008b81526020902060005b868110156110b157815484820152908501908901611098565b83019750505b50949998505050505050505050565b6060815260006110d96060830186610f11565b82810360208401526110eb8186610f11565b915050826040830152949350505050565b60408152600061110f6040830185610f11565b9050826020830152939250505056fea2646970667358221220e68bd3e315f6dcde5d9262b3ceb568cc3e825cada5e0c7187314ca149baae57064736f6c63430008090033a26469706673582212207f9a4e08e61c50f642cdbfd94cc1181e4a84745ef746f76f9b6cc622ce31c0d764736f6c63430008090033\",\"name\":\"brc-20\",\"op\":\"create\",\"p\":\"brczero\",\"waitinit\":true}" \
  --inscription_context "{\"inscription_id\":\"46d116b777590ef08dc94f8b54d91ac9fa6e28bc3f06f574f8f2e75dc0d1db32i0\",\"inscription_number\":0,\"is_transfer\":false,\"txid\":\"46d116b777590ef08dc94f8b54d91ac9fa6e28bc3f06f574f8f2e75dc0d1db32\",\"sender\":\"bcrt1qd28jewrz9y9hpl328em5fpljvgarucgcxf7fjt\",\"receiver\":\"bcrt1qd28jewrz9y9hpl328em5fpljvgarucgcxf7fjt\",\"commit_input\":\"\",\"reveal_output\":\"\",\"old_sat_point\":\"9fdc76fe873b11566dff1adabe4b6fd92be3cd832445b8b2b1b7e4e452c23eeb:0:0\",\"new_sat_point\":\"46d116b777590ef08dc94f8b54d91ac9fa6e28bc3f06f574f8f2e75dc0d1db32:0:0\",\"block_hash\":\"071844699637412cca4d38175eaf5420d27b454116efea1c3d20a36548befd5e\",\"block_time\":1700669916,\"block_height\":0}" \
  --home $HOME_SERVER \
  --chain-id $CHAINID
# Collect genesis tx
brczerod collect-gentxs --home $HOME_SERVER

# Run this to ensure everything worked and that the genesis file is setup correctly
brczerod validate-genesis --home $HOME_SERVER
brczerocli config keyring-backend test

run

sleep 4

